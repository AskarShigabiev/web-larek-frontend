# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

Приложение написано с помощью паттерна MVP. Состсоит из следующих компонентов:

- Model (Модель) -  Модель отвечает за управление данными, бизнес-логикой и состоянием приложения.
- View (Представление) - Представление отвечает за отображение данных и пользовательский интерфейс. Оно получает команды от презентера и обновляется в соответствии с изменениями данных.
- Presenter (Презентер) -  Презентер служит посредником между моделью и представлением. Он запрашивает данные у модели и обновляет представление в ответ на изменения.

### Базовые классы

**Api** - класс для выполненя GET, POST, PUT и DELETE запросов на сервер.
Методы/свойства класса:

- ````constructor```` - инициализирует базовый URL и устанавливает стандартные заголовки для HTTP-запросов.
- ````handleResponse```` - обрабатывает ответ от HTTP-запроса и проверяет его статус.
- ````get```` - отправляет GET запрос на сервер и обрабатывает его с помощью конструктора.
- ````post```` - по умолчанию отправляет POST (либо PUT/DELITE) запрос по URI и обрабатывает его с помощью конструктора.

**IEvents** - набор методов для управления событиями, обеспечивает взаимодействие между частями кода.

**EventEmitter** - класс управления событиями, дает возможность объектам подписываться на события и реагировать на них.
Методы/свойства класса:

- ````constructor```` - создает новый объект класса, который хранит информацию о событиях.
- ````on```` - регистрирует обработчик события.
- ````emit```` - создает функцию для триггера события с контекстом.
- ````trigger```` - метод для создания функции, которая будет запускать событие.

**Component** - абстрактный базовый класс для создания компонентов, которые работают с DOM-элементами.
Методы/свойства класса:

- ````constructor```` - конструктор принимает DOM-элемент, который будет использоваться в качестве корневого элемента для компонента.  Он предоставляет базовый набор методов для управления элементами и их свойствами.
- ````toggleClass```` - этот метод переключает класс у переданного элемента.
- ````setText```` - метод устанавливает текстовое содержимое элемента.
- ````setDisabled```` - изменяет состояние блокировки элемента.
- ````setHidden```` - метод скрывает элемент, устанавливая его стиль display в none.
- ````setVisible```` - делает элемент видимым, убирая стиль display.
- ````setImage```` -  устанавливает изображение и альтернативный текст у этого изображения.
- ````render```` - обновляет текущий экземпляр класса этими данными с помощью Object.assign, затем он возвращает корневой DOM-элемент.

**Model** - абстрактный базовый класс для моделей данных в приложении.
Методы/свойства класса:

- ````isModel```` - Эта функция проверяет, является ли переданный объект экземпляром класса Model.
- ````constructor```` - Конструктор принимает два аргумента: data - объект с данными, который будет использоваться для инициализации модели. events - объект, отвечающий за управление событиями.
- ````emitChanges```` - Этот метод используется для оповещения о том, что модель изменилась.

### Модели данных и компоненты отображения

**Basket** - предоставляет функциональность для управления корзиной покупок.
Методы/свойства класса:

- ````constructor```` - вызывает конструктор родительского класса Component, инициализирует защищенные свойства корзины и добавляет обработчик событий для кнопки.
- ````toggleButton```` -  метод переключает состояние блокировки кнопки.
- ````basketList```` - cеттер для установки списка элементов в корзине. Если список пуст, он добавляет сообщение "Корзина пуста".
- ````setPrice```` - устанавливает общую стоимость корзины. Если стоимость "бесценна", отображается соответствующее сообщение.

**Form** - предназначен для управления HTML-формой на веб-странице.
Методы/свойства класса:

- ````constructor```` - принимает два параметра: контейнер формы (HTMLFormElement) и объект для управления событиями (IEvents). Добавляет обработчики событий для ввода и отправки формы.
- ````onInputChange```` - метод вызывается при изменении значения любого поля ввода формы.
- ````valid```` - сеттер для свойства valid. Он изменяет состояние блокировки кнопки отправки формы в зависимости от валидности формы.
- ````errors```` - сеттер для свойства errors. Он устанавливает текст ошибок
- ````render```` - принимает частичное состояние формы и обновляет состояние компонента и его свойства.

**Modal** -  добавляет методы и свойства для управления модальным окном.
Методы/свойства класса:

- ````constructor```` - добавляет обработчики событий для закрытия модального окна.
- ````content```` - cеттер для свойства content. Он заменяет текущее содержимое _content новым элементом.
- ````open```` - метод для открытия модального окна.
- ````close```` - метод для закрытия модального окна.
- ````render```` - принимает данные для модального окна, обновляет состояние компонента и открывает модальное окно.

**Success** -  добавляет методы и свойства для управления сообщением об успешном заказе.
Методы/свойства класса:

- ````constructor```` - добавляет обработчик событий для кнопки закрытия.
- ````total```` - сеттер для свойства total. Он обновляет текстовое содержимое элемента с указанием общего количества списанных единиц.
- ````setText```` - метод для установки текстового содержимого элемента.
- ````render```` - возвращает элемент, который является контейнером для отображения информации об успешном заказе.

**AppState** -  включает методы для управления каталогом товаров, корзиной и данными для оформления заказа.
Методы/свойства класса:

- ````setCatalog```` - устанавливает список товаров каталога и уведомляет об изменении.
- ````addToBasket```` - добавляет товар в корзину.
- ````removeFromBasket```` - удаляет товар из корзины и уведомляет об изменении.
- ````sumPriceInBasket```` - вычисляет общую стоимость товаров в корзине.
- ````checkItemInBasket```` - проверяет наличие товара в корзине.
- ````checkPriceOfProducts```` - проверяет наличие товаров без цены в корзине.
- ````counterBasket```` - возвращает количество товаров в корзине.
- ````paymentSelect```` - устанавливает способ оплаты в зависимости от содержимого кнопки.
- ````validateOrder```` - проверяет корректность данных заказа.
- ````fillOrderInputs```` - возвращает данные заказа для отправки.
- ````cleanAll```` -  очищает все данные состояния.

**Card** - отвечает за управление карточкой товара на веб-странице. Предоставляет методы для установки данных карточки и управления взаимодействиями с ней.
Методы/свойства класса:

- ````constructor```` - инициализирует элементы карточки и устанавливает обработчики событий для кликов по карточке и кнопке.
- ````title```` - метод для установки заголовка.
- ````image```` - метод для установки изображения.
- ````price```` - метод для установки категории.
- ````buttonText```` - метод для установки текста кнопки.
- ````description```` - метод для установки описания.

**Contacts** - класс управляет элементами формы, такими как поля ввода для телефона и электронной почты.
Методы/свойства класса:

- ````constructor```` - принимает контейнер формы и объект событий, затем инициализирует элементы ввода для email и телефона.
- ````phoneSet```` - метод для установки  значения поля ввода телефона.
- ````emailSet```` - метод для установки значения поля ввода почты.
- ````getPhone```` - метод для установки значений поля ввода телефона.
- ````getEmail```` - метод для получения текущего значения поля  ввода почты.
- ````cleanContactInputs```` - метод для очистки значений полей ввода.

**Order** - представляет собой форму для оформления заказа, управляя вводом адреса и выбором способа оплаты.
Методы/свойства класса:

- ````constructor```` -конструктор принимает контейнер формы и объект событий, затем инициализирует элементы формы, такие как кнопки выбора способа оплаты и поле ввода адреса.
- ````getAddressInputValue```` - метод для получения текущего значения адреса
- ````cleanOrderSelections```` - метод для очистки выбора заказа.

**Page** - представляет собой компонент страницы, который управляет различными элементами, такими как счетчик корзины, каталог товаров и блокировка страницы. Класс также обрабатывает события, связанные с этими элементами.
Методы/свойства класса:

- ````constructor```` - принимает контейнер страницы и объект событий, затем инициализирует элементы страницы, такие как счетчик корзины, каталог товаров, обертка страницы и кнопку корзины.
- ````catalog```` - метод для замены элементов каталога.
- ````counter```` - метод для обновления текста счетчика корзины.
- ````locked```` - метод для блокировки и разблокировки страницы.

### Классы для комуникации

**WebLarekAPI** - расширяет функциональность базового класса Api. Он предоставляет методы для взаимодействия с API, чтобы получать список карточек продуктов, информацию о конкретной карточке продукта и оформлять заказы.
Методы/свойства класса:

- ````constructor```` -  вызывает конструктор родительского класса Api с baseUrl и options, а также инициализирует свойство cdn.
- ````getCardList```` -  метод для получения списка карточек продуктов, выполняет GET-запрос.
- ````getCardItem```` - метод для получения информации о конкретной карточке продукта по ее идентификатору выполняет GET-запрос.
- ````orderCards```` - метод для оформления заказа на карточки продуктов, выполняет POST-запрос.

### Описание событий

````catalog:changed```` - обновляет каталог на странице.

````card:select```` - открывает превью карточки.

````basket:open```` - открывает модальное окно корзины.

````basket:change```` - обновляет содержимое корзины и сумму покупки.

````order:open```` - открывает модальное окно с формой заказа.

````order:submit```` - открывает модальное окно с формой ввода контактных данных.

````success:open```` - очищает корзину и открывает модальное окно с подтверждением заказа.

````card:add```` - добавляет продукт в корзину.

````card:remove```` - удаляет продукт из корзины.

````contacts:submit```` - отправляет заказ на сервер и обрабатывает результат.

````delete:all```` - очищает все поля ввода и данные корзины.

````modal:open```` - блокирует прокрутку страницы.

````modal:close```` - разблокирует прокрутку страницы.

````/^order|contacts\..*:change/```` - обновляет данные заказа.
